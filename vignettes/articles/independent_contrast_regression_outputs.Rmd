---
title: "Processing output data from independent contrast regressions"
output: rmarkdown::html_vignette
resource_files:
    - bayes_factor_heatmap.png
    - bayes_factor_heatmap_cluster.png
    - word_table_model_comparisons.png
vignette: >
  %\VignetteIndexEntry{Processing output data from independent contrast regressions}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

The main goal of the __InNOutBT__ package is to readily create input data to and
process output data from Meade & Pagel's (2022) [BayesTraits](http://www.evolution.reading.ac.uk/BayesTraitsV4.0.0/BayesTraitsV4.0.0.html) 
computer package.\

Here in this article, we show how to use the package's function `BayesTraits.outputs`
for processing all Log and Stones .txt output files from BayesTraits phylogenetic 
independent contrast regression analyses.\


# Setup

__InNOutBT__ is not on CRAN yet but you can install the latest development version 
from [GitHub](https://github.com/):

``` r
#install.packages("devtools")
devtools::install_github("DBOSlab/InNOutBT")
```
```{r, eval = FALSE}
library(InNOutBT)
```


# Processing Log and Stone output files

The function `BayesTraits.outputs` reads and processes all Log and Stones .txt 
output files resulting from the phylogenetic regressions and automatically generates
tables either in Word or CSV formats summarizing each model, including comparison 
with Bayes Factor. Heatmaps based on pairwise Bayes Factor comparison are also 
automatically produced in PDF format.\

```{r, eval = FALSE}
library(InNOutBT)

BayesTraits.outputs(logst_dir = paste0(getwd(),"/BayesTraits_outputs_log_stone"),
                    responvar = "DBH",
                    explanvar = c("bio12", "bio15", "nnodes"),
                    treetransf = c("Kappa", "Delta", "Lambda", "OU"),
                    bayesfactor = TRUE,
                    unirates = FALSE,
                    outformat = c("Word", "CSV"),
                    tableleg = "Phylogenetic regression in BayesTraits: models and coefficients.",
                    dir_create = "results_BayesTraits_output",
                    outfile = "BayesTraits_output_table",
                    height = 12,
                    width = 15)
```

Heatmap including Bayes Factor pairwise comparison.\
\
```{r, echo = FALSE}
knitr::include_graphics("figures/bayes_factor_heatmap.png", dpi = 300)
```

Heatmap clustering models based on Bayes Factor values.\
\
```{r, echo = FALSE}
knitr::include_graphics("figures/bayes_factor_heatmap_cluster.png", dpi = 300)
```

Table describing the models and coefficients.\
\
```{r, echo = FALSE}
knitr::include_graphics("figures/word_table_model_comparisons.png", dpi = 300)
```


See also an associated article on how to automatically [create input files ](https://dboslab.github.io/InNOutBT/articles/independent_contrast_regression_inputs.html)) 
with `BayesTraits.inputs` for the phylogenetic regression analyses, as well as 
another article on how to create a [shell script](https://dboslab.github.io/InNOutBT/articles/independent_contrast_regression_shell.html)) 
with `BayesTraits.shell` for one or all-in-once multiple analyses.
