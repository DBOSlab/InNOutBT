<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="This package helps to automate BayesTraits phylogenetic independent contrast regression analyses.">
<title>An R package for creating input data to and processing output data from BayesTraits analyses • InNOutBT</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="An R package for creating input data to and processing output data from BayesTraits analyses">
<meta property="og:description" content="This package helps to automate BayesTraits phylogenetic independent contrast regression analyses.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">InNOutBT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/independent_contrast_regression_inputs.html">Creating input data for independent contrast regression analysis</a>
    <a class="dropdown-item" href="articles/independent_contrast_regression_outputs.html">Processing output data from independent contrast regression analysis</a>
    <a class="dropdown-item" href="articles/independent_contrast_regression_shell.html">Shell scripts for independent contrast regression analysis</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/DBOSlab/InNOutBT/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="innoutbt-">InNOutBT <img src="reference/figures/innoutbt.png" align="right" alt="" width="120"><a class="anchor" aria-label="anchor" href="#innoutbt-"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>An R package for creating input data and processing output data in formats required of Meade &amp; Pagel’s (2022) <a href="http://www.evolution.reading.ac.uk/BayesTraitsV4.0.0/BayesTraitsV4.0.0.html" class="external-link">BayesTraits</a> computer package.</p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The package <strong>InNOutBT</strong> remains under development. Currently, it has three major functions that help to automate BayesTraits phylogenetic independent contrast regression analyses. To better understand how these functions work, see <a href="http://www.evolution.reading.ac.uk/BayesTraitsV4.0.0/Files/BayesTraitsV4.0.0-Manual.pdf" class="external-link">BayesTraits V4.0.0 Manual</a> for further details on the specific format of the input files that are required by BayesTraits, as well as the BayesTraits strucuture of resulting output files.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of InNOutBT from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"DBOSlab/InNOutBT"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://DBOSlab.github.io/InNOutBT">InNOutBT</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>A general description of each of the three available functions (<code>BayesTraits.inputs</code>, <code>BayesTraits.shell</code>, and <code>BayesTraits.outputs</code>) are provided below.</p>
<div class="section level4">
<h4 id="id_1-bayestraitsinputs-creating-input-mean-and-linked-data-for-phylogenetic-regression-analyses">
<em>1. <code>BayesTraits.inputs</code>: Creating input mean and linked data for phylogenetic regression analyses</em><a class="anchor" aria-label="anchor" href="#id_1-bayestraitsinputs-creating-input-mean-and-linked-data-for-phylogenetic-regression-analyses"></a>
</h4>
<p>This function produces the required BayesTraits input data of linked samples of trait/climate data (distribution data), by generating two text files, one of which includes the mean values associated with each trait associated with a terminal taxon and a second of which reports samples of trait values that are linked to each other because they were sampled from one accession of the associated terminal taxon. The function also includes an argument to calculate the net node count for each species/accession given a phylogenetic tree. Net node counts have been used to explore the effects of speciation rates on the response variable (e.g. <a href="https://doi.org/10.1038/s41559-017-0454-6" class="external-link">O’Donovan et al. 2018</a>).</p>
<div class="section level5">
<h5 id="example-of-using-bayestraitsinputs">Example of using <code>BayesTraits.inputs</code>:<a class="anchor" aria-label="anchor" href="#example-of-using-bayestraitsinputs"></a>
</h5>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://DBOSlab.github.io/InNOutBT">InNOutBT</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/YuLab-SMU/treeio" class="external-link">treeio</a></span><span class="op">)</span>

<span class="va">traitdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"Data/vataireoids_1610_25May2022_BayesTraits.csv"</span><span class="op">)</span>
<span class="va">phylo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/treeio/reference/beast-parser.html" class="external-link">read.beast</a></span><span class="op">(</span><span class="st">"Data/vatcomb30_24May22_Yule.con.tree"</span><span class="op">)</span>

<span class="fu"><a href="reference/BayesTraits.inputs.html">BayesTraits.inputs</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">phylo</span>,
                   data <span class="op">=</span> <span class="va">traitdata</span>,
                   tipscol <span class="op">=</span> <span class="st">"terminal"</span>,
                   NodeCount <span class="op">=</span> <span class="cn">TRUE</span>,
                   logtransf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DBH"</span>, <span class="st">"NodeCount"</span><span class="op">)</span>,
                   traitcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bio12"</span>, <span class="st">"bio15"</span><span class="op">)</span>,
                   addtraits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log10NodeCount"</span>, <span class="st">"log10DBH"</span><span class="op">)</span>,
                   ordtraits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log10DBH"</span>, <span class="st">"bio12"</span>, <span class="st">"bio15"</span>, <span class="st">"log10NodeCount"</span><span class="op">)</span>,
                   dir_create <span class="op">=</span> <span class="st">"results_BayesTraits_input"</span>,
                   fileDistData <span class="op">=</span> <span class="st">"BayesTraits_linked_data_bio12_bio15_nnodes.txt"</span>,
                   fileMeanData <span class="op">=</span> <span class="st">"BayesTraits_mean_data_bio12_bio15_nnodes.txt"</span>,
                   fileOrigData <span class="op">=</span> <span class="st">"vataireoids_1610_25May2022_BayesTraits_netnodes_logtransf.csv"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="id_2-bayestraitsshell-creating-shell-script-for-running-phylogenetic-regression-analyses">
<em>2. <code>BayesTraits.shell</code>: Creating shell script for running phylogenetic regression analyses</em><a class="anchor" aria-label="anchor" href="#id_2-bayestraitsshell-creating-shell-script-for-running-phylogenetic-regression-analyses"></a>
</h4>
<p>Using directory paths to the tree and the input files of mean and linked trait data, this function produces shell scripts in both Unix and Windows PowerShell formats for running one or multiple phylogenetic regression analyses. This function creates the necessary batch file commands, including the desired settings for the burnin, iterations, and stepping stones parameters (e.g., abbreviated as bi, it, sa, and st) for a given run, in addition to incorporating any model of tree transformation. In the example below, we use “UNI”, “Lambda”, and “VR” in the treefransf argument to indicate we want three separate sets of batch file commands all identical except one, designated as “UNI” will not estimate “Lambda” or “VR” (variable rates). We use “UNI” to indicate the assumption of uniform rates of evolution and no other tree transformation (e.g., such as estimating “Lambda”). In this case, “UNI” here will consider a default BayesTraits regression analysis where “Lambda” assumes the default setting of 1.0 (see the BayesTraits manual).</p>
<div class="section level5">
<h5 id="example-of-using-bayestraitsshell">Example of using <code>BayesTraits.shell</code>:<a class="anchor" aria-label="anchor" href="#example-of-using-bayestraitsshell"></a>
</h5>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://DBOSlab.github.io/InNOutBT">InNOutBT</a></span><span class="op">)</span>

<span class="fu"><a href="reference/BayesTraits.shell.html">BayesTraits.shell</a></span><span class="op">(</span>meanfile_dir <span class="op">=</span> <span class="st">"results_BayesTraits_input/03Jun2022"</span>,
                  linkfile_dir <span class="op">=</span> <span class="st">"results_BayesTraits_input/03Jun2022"</span>,
                  treefile_dir <span class="op">=</span> <span class="st">"Data"</span>,
                  BayesTraits_dir <span class="op">=</span> <span class="st">"/Users/domingoscardoso/BayesTraitsV4"</span>,
                  responvar <span class="op">=</span> <span class="st">"DBH"</span>,
                  treetransf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UNI"</span>, <span class="st">"Kappa"</span>, <span class="st">"Lambda"</span>, <span class="st">"VR"</span><span class="op">)</span>,
                  bi <span class="op">=</span> <span class="st">"30000000"</span>,
                  it <span class="op">=</span> <span class="st">"130000000"</span>,
                  sa <span class="op">=</span> <span class="st">"100000"</span>,
                  st <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"500"</span>, <span class="st">"50000"</span><span class="op">)</span>,
                  syst <span class="op">=</span> <span class="st">"unix"</span>,
                  dir_create <span class="op">=</span> <span class="st">"results_BayesTraits_shell"</span>,
                  cc_DataTree <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="id_3-bayestraitsoutputs-processing-output-data-from-phylogenetic-regression-analyses">
<em>3. <code>BayesTraits.outputs</code>: Processing output data from phylogenetic regression analyses</em><a class="anchor" aria-label="anchor" href="#id_3-bayestraitsoutputs-processing-output-data-from-phylogenetic-regression-analyses"></a>
</h4>
<p>This function processes the output Log and Stones .txt files from phylogenetic regression analyses. The resulting processed files are tables either in Word or CSV formats summarizing each model, including comparisons of Bayes Factors. Heatmaps using pairwise Bayes Factor comparisons are also produced in PDF format (we use heatmaps only to identify models similar to the model with the highest likelihood score).</p>
<div class="section level5">
<h5 id="example-of-using-bayestraitsoutputs">Example of using <code>BayesTraits.outputs</code>:<a class="anchor" aria-label="anchor" href="#example-of-using-bayestraitsoutputs"></a>
</h5>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://DBOSlab.github.io/InNOutBT">InNOutBT</a></span><span class="op">)</span>

<span class="fu"><a href="reference/BayesTraits.outputs.html">BayesTraits.outputs</a></span><span class="op">(</span>logst_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,<span class="st">"/BayesTraits_outputs_log_stone"</span><span class="op">)</span>,
                    responvar <span class="op">=</span> <span class="st">"DBH"</span>,
                    explanvar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bio12"</span>, <span class="st">"bio15"</span>, <span class="st">"nnodes"</span><span class="op">)</span>,
                    treetransf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UNI"</span>, <span class="st">"Kappa"</span>, <span class="st">"Lambda"</span>, <span class="st">"VR"</span><span class="op">)</span>,
                    bayesfactor <span class="op">=</span> <span class="cn">TRUE</span>,
                    unirates <span class="op">=</span> <span class="cn">FALSE</span>,
                    outformat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Word"</span>, <span class="st">"CSV"</span><span class="op">)</span>,
                    tableleg <span class="op">=</span> <span class="st">"Phylogenetic regression in BayesTraits: models and coefficients."</span>,
                    dir_create <span class="op">=</span> <span class="st">"results_BayesTraits_output"</span>,
                    outfile <span class="op">=</span> <span class="st">"BayesTraits_output_table"</span>,
                    height <span class="op">=</span> <span class="fl">17</span>,
                    width <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<p>A detailed description of the <strong>InNOutBT</strong>’s full functionality is available in different <a href="https://dboslab.github.io/InNOutBT/" class="external-link">articles</a>.</p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>Cardoso, D. &amp; Lavin, M. (2022). InNOutBT: An R package for creating input data and processing output data required for BayesTraits analyses. <a href="https://github.com/dboslab/InNOutBT" class="external-link uri">https://github.com/dboslab/InNOutBT</a></p>
<p><img src="reference/figures/DBOSlab_logo.png" align="left" alt="" width="150"></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/DBOSlab/InNOutBT/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/DBOSlab/InNOutBT/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing InNOutBT</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Domingos Cardoso <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-7072-2656" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Matt Lavin <br><small class="roles"> Author, contributor </small> <a href="https://orcid.org/0000-0003-4205-1802" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Domingos Cardoso, Matt Lavin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
