<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function produces BayesTraits input data that comprises samples
of trait/climate data (distribution data) for phylogenetic regression analyses
with Meade &amp;amp; Pagel's (2022) BayesTraits
program. The function generates two text files. One includes linked samples
of trait data and the other the mean values for samples of trait data. The function
also includes an argument to calculate the net node count for each species or
terminal taxon given a phylogenetic tree. Net nodes can serve as an explanatory
variable to explore the effect of speciation rates on the response variable
(e.g., O’Donovan et al. 2018).
See BayesTraits V4.0.0 Manual
for further details on the specific format of the input files that are required
by BayesTraits."><title>Produces BayesTraits mean and linked input data comprising samples of trait data — BayesTraits.inputs • InNOutBT</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Produces BayesTraits mean and linked input data comprising samples of trait data — BayesTraits.inputs"><meta property="og:description" content="This function produces BayesTraits input data that comprises samples
of trait/climate data (distribution data) for phylogenetic regression analyses
with Meade &amp;amp; Pagel's (2022) BayesTraits
program. The function generates two text files. One includes linked samples
of trait data and the other the mean values for samples of trait data. The function
also includes an argument to calculate the net node count for each species or
terminal taxon given a phylogenetic tree. Net nodes can serve as an explanatory
variable to explore the effect of speciation rates on the response variable
(e.g., O’Donovan et al. 2018).
See BayesTraits V4.0.0 Manual
for further details on the specific format of the input files that are required
by BayesTraits."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">InNOutBT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/independent_contrast_regression_inputs.html">Creating input data for independent contrast regression analysis</a>
    <a class="dropdown-item" href="../articles/independent_contrast_regression_outputs.html">Processing output data from independent contrast regressions</a>
    <a class="dropdown-item" href="../articles/independent_contrast_regression_shell.html">Shell scripts for independent contrast regressions</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/DBOSlab/InNOutBT/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Produces BayesTraits mean and linked input data comprising samples of trait data</h1>
      <small class="dont-index">Source: <a href="https://github.com/DBOSlab/InNOutBT/blob/HEAD/R/BayesTraits_inputs.R" class="external-link"><code>R/BayesTraits_inputs.R</code></a></small>
      <div class="d-none name"><code>BayesTraits.inputs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function produces BayesTraits input data that comprises samples
of trait/climate data (distribution data) for phylogenetic regression analyses
with Meade &amp; Pagel's (2022) <a href="http://www.evolution.reading.ac.uk/BayesTraitsV4.0.0/BayesTraitsV4.0.0.html" class="external-link">BayesTraits</a>
program. The function generates two text files. One includes linked samples
of trait data and the other the mean values for samples of trait data. The function
also includes an argument to calculate the net node count for each species or
terminal taxon given a phylogenetic tree. Net nodes can serve as an explanatory
variable to explore the effect of speciation rates on the response variable
(e.g., <a href="https://doi.org/10.1038/s41559-017-0454-6" class="external-link">O’Donovan et al. 2018</a>).
See <a href="http://www.evolution.reading.ac.uk/BayesTraitsV4.0.0/Files/BayesTraitsV4.0.0-Manual.pdf" class="external-link">BayesTraits V4.0.0 Manual</a>
for further details on the specific format of the input files that are required
by BayesTraits.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">BayesTraits.inputs</span><span class="op">(</span><span class="va">tree</span>,
                   <span class="va">data</span>,
                   tipscol <span class="op">=</span> <span class="cn">NULL</span>,
                   NodeCount <span class="op">=</span> <span class="cn">FALSE</span>,
                   logtransf <span class="op">=</span> <span class="cn">NULL</span>,
                   sqrtransf <span class="op">=</span> <span class="cn">NULL</span>,
                   traitcols <span class="op">=</span> <span class="cn">NULL</span>,
                   addtraits <span class="op">=</span> <span class="cn">NULL</span>,
                   ordtraits <span class="op">=</span> <span class="cn">NULL</span>,
                   dir_create <span class="op">=</span> <span class="st">"results_BayesTraits_input"</span>,
                   fileDistData <span class="op">=</span> <span class="st">"BayesTraits_linked_input.txt"</span>,
                   fileMeanData <span class="op">=</span> <span class="st">"BayesTraits_mean_input.txt"</span>,
                   fileOrigData <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>tree</dt>
<dd><p>The input tree file. This can be either a Newick-formatted tree
imported by <code>ape</code>'s function <code>read.tree</code> or a treedata-formatted
phylogeny as generated by <a href="https://beast.community" class="external-link">BEAST</a> and read by
<code>treeio</code>'s function <code>read.beast</code>.</p></dd>


<dt>data</dt>
<dd><p>The input sample of trait (distribution) data in data frame format.
A column must be included that links multiple trait values for each terminal
branch label of the input phylogeny (i.e., each species or accession).</p></dd>


<dt>tipscol</dt>
<dd><p>Report the name of the column with terminal or tip labels to be
included in the input file containing the mean and linked samples of trait data.
Terminal labels on the phylogeny tree have to match row labels in the data files
containing mean and linked samples of trait data.</p></dd>


<dt>NodeCount</dt>
<dd><p>Logical, if <code>TRUE</code>, the function will create
a new column NodeCount, or net nodes, for each terminal label. Net nodes or node
count will be reported in the mean of the samples of trait data and will be replicated
for every accession of each terminal label in the linked samples of trait data.</p></dd>


<dt>logtransf</dt>
<dd><p>A vector with the name of the column(s) in the original trait data
to be log10-transformed. For example, if you report the columns c("DBH", "NodeCount")
to be log10-transformed, the function will generate "log10DBH" and "logNodeCount"
for the BayesTraits input data files. If these traits are to be included in an
analysis, list them as argument in <code>addtraits</code> (see below).</p></dd>


<dt>sqrtransf</dt>
<dd><p>A vector with the name of the column(s) in the original trait data
to be log10-transformed squared. For example, if you define Nodecount to be log10-
transformed squared because speciation rates may have recently slowed, the function
will generate "sqrNodeCount" for the BayesTraits input data containing samples
of traits. If sqrNodeCount is to be included in an analysis, list it as argument
in <code>addtraits</code> (see below).</p></dd>


<dt>traitcols</dt>
<dd><p>A vector with the name of the column(s) in the original trait
data that will serve as the response or dependent variable (first column name)
and the explanatory or independent variable(s) (second and possibly a third
and fourth column) for the phylogenetic regression analysis.</p></dd>


<dt>addtraits</dt>
<dd><p>A vector with the name of additional column(s) that are not
originally in the input trait data but for which you want to generate inputs
of linked samples of trait data and mean data. For example, if you have chosen
<code>NodeCount=TRUE</code> and defined any new columns to be log10-transformed or
log10-transformed squared, they should be listed here as additional trait data
to be included in the linked sample of traits.</p></dd>


<dt>ordtraits</dt>
<dd><p>A vector listing the order of trait names to be used in
the BayesTraits analysis. This ensures that the first trait listed will serve
as the response variable, and that subsequently listed traits serve as explanatory
variables. Maintaining a consistent order of the names of the explanatory variables
among competing nested and non-nested models will facilitate the interpretation of
coefficient estimates reported for Beta1, Beta2, etc. in the BayesTraits log files.</p></dd>


<dt>dir_create</dt>
<dd><p>Path to directory where results will be saved. The default
creates a directory named <strong>results_BayesTraits_input</strong> and the results will
be saved within a subfolder of that directory named with the current date.</p></dd>


<dt>fileDistData</dt>
<dd><p>Name of the resulting text file containing linked samples
of trait data. If no name is given, the default setting creates a file named
<em>BayesTraits_linked_input.txt</em>.</p></dd>


<dt>fileMeanData</dt>
<dd><p>Name of the resulting text file containing mean trait data.
If no name is given, the default setting creates a file named <em>BayesTraits_mean_input.txt</em>.</p></dd>


<dt>fileOrigData</dt>
<dd><p>If you define any name here, the originally imported file
of trait data will be saved as a CSV file, including any newly generated data
columns. This new file of trait data will be written to the directory as set
in the argument <code>dir_create</code>, but outside the current-date subfolder.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="BayesTraits.shell.html">BayesTraits.shell</a></code></p>
<p><code><a href="BayesTraits.outputs.html">BayesTraits.outputs</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Domingos Cardoso &amp; Matt Lavin</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://DBOSlab.github.io/InNOutBT">InNOutBT</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Loading a example data file</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vatsData</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Loading a example tree file</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vatsTree</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">BayesTraits.inputs</span><span class="op">(</span>tree <span class="op">=</span> <span class="va">vatsTree</span>,</span>
<span class="r-in">                   data <span class="op">=</span> <span class="va">vatsData</span>,</span>
<span class="r-in">                   tipscol <span class="op">=</span> <span class="st">"terminal"</span>,</span>
<span class="r-in">                   NodeCount <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">                   logtransf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DBH"</span>, <span class="st">"NodeCount"</span><span class="op">)</span>,</span>
<span class="r-in">                   traitcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bio12"</span>, <span class="st">"bio15"</span><span class="op">)</span>,</span>
<span class="r-in">                   addtraits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log10NodeCount"</span>, <span class="st">"log10DBH"</span><span class="op">)</span>,</span>
<span class="r-in">                   ordtraits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log10DBH"</span>, <span class="st">"bio12"</span>, <span class="st">"bio15"</span>, <span class="st">"log10NodeCount"</span><span class="op">)</span>,</span>
<span class="r-in">                   dir_create <span class="op">=</span> <span class="st">"results_BayesTraits_input"</span>,</span>
<span class="r-in">                   fileDistData <span class="op">=</span> <span class="st">"BayesTraits_linked_data_bio12_bio15_nnodes.txt"</span>,</span>
<span class="r-in">                   fileMeanData <span class="op">=</span> <span class="st">"BayesTraits_mean_data_bio12_bio15_nnodes.txt"</span>,</span>
<span class="r-in">                   fileOrigData <span class="op">=</span> <span class="st">"vataireoids_1610_25May2022_BayesTraits_netnodes_logtransf.csv"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Domingos Cardoso, Matt Lavin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer></div>

  

  

  </body></html>

